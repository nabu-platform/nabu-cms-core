<sequence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		disabled="false"
		id="b68753f3-1fb8-4796-bdcc-d481f8e1490d"
		lineNumber="1">
	<steps xsi:type="be.nabu.libs.services.vm.step.Map"
			disabled="false"
			id="672e503a-bb9b-478d-8e26-63eeca0d215d"
			lineNumber="2">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="6592c709-ed0c-4a46-8e03-885f67e54cfe"
				serviceId="nabu.utils.String.split"
				resultName="result193035c0f2294a95a9d6fb391705d4c7"
				temporaryMapping="true"
				x="159"
				y="140"
				invocationOrder="0"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="f1f35afb-b38c-4ed6-bdcf-ed6553cd2936"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>:</from>
				<to>separator</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="39359417-9bfb-46f1-9650-1b40176d28c6"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>input/cookie/Remember</from>
				<to>string</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="cf2dff87-62df-4141-bd81-d169111a916a"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>result193035c0f2294a95a9d6fb391705d4c7/parts[0]</from>
			<to>authentication/id</to>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="e225461a-842d-4071-83a4-8a4a02646060"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>result193035c0f2294a95a9d6fb391705d4c7/parts[1]</from>
			<to>authentication/secret</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
			comment="If we can't go further, we assume you are anonymous"
			disabled="false"
			id="5703ad36-69d3-4dbe-894d-ef5197295c74"
			label="authentication/id == null || authentication/secret == null"
			lineNumber="3">
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				comment="Add $guest"
				disabled="false"
				id="072236fa-b980-4a30-a818-38930774729e"
				lineNumber="4">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="5527d458-b410-43e6-bc18-18a6e33489b0"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>$guest</from>
				<to>output/content/roles[0]</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Break"
				comment="Fail gracefully"
				disabled="false"
				id="8dfe2b05-254c-4aa6-9d5f-a62e6c4bf8ba"
				lineNumber="5">
			<count>2</count>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
			disabled="false"
			id="f182e16e-edd9-493e-9cd7-b083be9dd815"
			lineNumber="6">
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				disabled="false"
				id="5a0b914b-3b84-4867-8527-9ff1205a9928"
				lineNumber="7">
			<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
					disabled="false"
					id="bd5dccc0-1f5b-4f51-a2ca-67ca846047ed"
					path="authentication" xsi:nil="true"/>
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="1711daa6-db07-4ee9-9de1-db7bbaee6186"
					serviceId="nabu.web.application.Services.temporarilyAuthenticate"
					resultName="result605fa12863834226ae1ecd615548fe91"
					temporaryMapping="true"
					x="424"
					y="60"
					invocationOrder="1"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="50141e57-9153-4cef-9889-c141c7b0aefb"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>authentication</from>
					<to>authentication</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="c0fb080b-a248-4604-b39f-790de44aca6c"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>remember</from>
					<to>type</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="6e2d0148-6d4c-4b33-ad00-25620491e898"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>input/device</from>
					<to>device</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="1ac71f43-f78a-4b69-8cc6-4dca1d574b40"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>input/webApplicationId</from>
					<to>webApplicationId</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="cb920204-7241-4ed7-b583-3513a59134be"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result605fa12863834226ae1ecd615548fe91/response</from>
				<to>token</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Catch"
				comment="If we can't authenticate, we need to unset the remember"
				disabled="false"
				id="127c0a74-2d21-4fb9-af1b-3858a28cb330"
				lineNumber="8">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map"
					comment="Drop the authentication"
					disabled="false"
					id="346d10d4-55db-49ad-bec1-e78a05a2c058"
					lineNumber="9">
				<steps xsi:type="be.nabu.libs.services.vm.step.Drop"
						disabled="false"
						id="3873bb23-b4d5-4af5-8334-7e1441ac377c"
						path="authentication" xsi:nil="true"/>
			</steps>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map"
			comment="If we successfully authenticated, create a new temporary authentication to serve as opaque token"
			disabled="false"
			id="23aae063-5611-441c-b8ba-81646fc2e4e9"
			label="token"
			lineNumber="10">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="3f76f2e0-d31f-4ef6-8cdc-96eee2c8d4e9"
				serviceId="nabu.web.application.Services.newTemporaryAuthentication"
				resultName="result38fdba2a82f3472bb37630b2fef0e2a5"
				temporaryMapping="true"
				x="530"
				y="83"
				invocationOrder="1"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="74c6ffc7-2cf9-49b8-aa7d-d00c430b735c"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>opaqueToken</from>
				<to>type</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="8e5ebf0c-0b52-4db0-adf5-37bc13a00999"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>token/name</from>
				<to>alias</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="09d51b91-8e51-48fb-b912-38f09a834656"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>resulte12d61efd27f480cb26876e13ac96e54/date</from>
				<to>until</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="b3699769-e579-417b-ac20-2eb66c3d5f46"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>PT30M</from>
				<to>timeout</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="136ccce2-9980-44d0-9a0e-4bea2c07b884"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>token/authenticationId</from>
				<to>authenticationId</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="4ed79eda-aad8-4da6-9457-bb1dd5ccc57b"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>input/device</from>
				<to>device</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="39dcac1f-751a-49d6-80e9-bda38f1b952d"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>input/webApplicationId</from>
				<to>webApplicationId</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="3a735d3d-9f01-47c0-ab95-0695536adc51"
				serviceId="nabu.utils.Date.incrementDuration"
				resultName="resulte12d61efd27f480cb26876e13ac96e54"
				temporaryMapping="true"
				x="114"
				y="305"
				invocationOrder="0"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="3d596450-37c4-4f84-8597-325c51d966c9"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>P1D</from>
				<to>duration</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="27bb6536-14c8-4da1-94cc-7ab4754e29b8"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>result38fdba2a82f3472bb37630b2fef0e2a5/authentication</from>
			<to>authentication</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map"
			comment="Set the token"
			disabled="false"
			id="609602c6-1501-4466-b0a7-e5c8f7ea0da7"
			label="authentication"
			lineNumber="11">
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="aca3a036-8c4e-41d5-8a24-3923f586b6c3"
				mask="false"
				optional="false"
				fixedValue="true">
			<from>=authentication/id + ":" + authentication/secret</from>
			<to>output/content/token</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Map"
			disabled="false"
			id="9f102dc2-7664-4715-853b-af401c873e9e"
			label="token"
			lineNumber="12">
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="7bad8fb7-e370-4371-9c38-dd656d379083"
				serviceId="nabu.web.application.Services.newTemporaryAuthentication"
				resultName="resultbd704e4d461b47d2b1d09c9951965ff7"
				temporaryMapping="true"
				x="559"
				y="66"
				invocationOrder="1"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="ec33928a-2fa8-4e69-ab67-9765a3f569b9"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>remember</from>
				<to>type</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="fd47c34f-6b27-4121-975e-7bbb998de07f"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>token/name</from>
				<to>alias</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="f58b5298-6010-4678-a904-2772050b02c1"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>token/authenticationId</from>
				<to>authenticationId</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="40c28128-3c49-4281-b34e-5a30658b2630"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result9aa9606ef5e74c0997bb3602bcfbe337/date</from>
				<to>until</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="fb13d3f1-6729-4d2e-92e3-edb7b4737939"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>1</from>
				<to>maxUses</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="fdbf9161-df3e-4fab-bc28-785da46aa261"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>input/device</from>
				<to>device</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="567f02c2-a611-4343-946e-09afda1f9bf5"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>input/webApplicationId</from>
				<to>webApplicationId</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
				disabled="false"
				id="c1694a74-af40-4f07-a6f7-1509edb01b69"
				serviceId="nabu.utils.Date.incrementDuration"
				resultName="result9aa9606ef5e74c0997bb3602bcfbe337"
				temporaryMapping="true"
				x="51"
				y="312"
				invocationOrder="0"
				asynchronous="false"
				recache="false">
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="d36d445a-6c57-4e2b-a4a3-ece66597af59"
					mask="false"
					optional="false"
					fixedValue="true">
				<from>P1Y</from>
				<to>duration</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="daefb478-372d-495b-84e5-70fd22159aa6"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>resultbd704e4d461b47d2b1d09c9951965ff7/authentication</from>
			<to>authentication</to>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Link"
				disabled="false"
				id="bb9d888a-40cd-4eb4-9659-4854cf61614e"
				mask="false"
				optional="false"
				fixedValue="false">
			<from>result9aa9606ef5e74c0997bb3602bcfbe337/date</from>
			<to>expires</to>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
			comment="Update remember cookie if needed"
			disabled="false"
			id="242c8df8-ad70-46f1-8953-bfb5f01b2404"
			lineNumber="13">
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				disabled="false"
				id="a39cee48-849d-4ef7-a0c5-94d427a72428"
				label="authentication"
				lineNumber="14">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="272b0892-e80f-4286-a7b0-0009bdd2e453"
					serviceId="nabu.web.application.Services.formatCookie"
					resultName="result9cb5728e344f47af8f4d9a5a93fc8bd1"
					temporaryMapping="true"
					x="434"
					y="123"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="fde1a56e-ae56-47ed-ab3d-1e9950c6b0eb"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>Remember</from>
					<to>key</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="dd97bc71-2fd2-4aeb-9982-797bb3946002"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>=authentication/id + ":" + authentication/secret</from>
					<to>value</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="30bcdaf5-b6f0-4f1b-9e5a-b740ea568d60"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>expires</from>
					<to>expires</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="ec5a6058-a162-4cab-a84a-1f4d9fc70945"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>input/webApplicationId</from>
					<to>webApplicationId</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="0e7e8fd0-5de5-4ff9-88b8-17eeb1da04c9"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result9cb5728e344f47af8f4d9a5a93fc8bd1/cookie</from>
				<to>output/header/setCookie</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				comment="If we can't remember and we have a cookie, forget it"
				disabled="false"
				id="6c9490efb17b4b4387eef3215a61232d"
				label="input/cookie/Remember != null"
				lineNumber="15">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="9026ba08a4aa4ea3827d4d59138a187e"
					serviceId="nabu.web.application.Services.formatCookie"
					resultName="result9cb5728e344f47af8f4d9a5a93fc8bd1"
					temporaryMapping="true"
					x="434"
					y="123"
					invocationOrder="1"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="6316a97464c8449e8d3a9c68949a985c"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>Remember</from>
					<to>key</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="5397d62e6abf4afc9d37fc6c4275cc1a"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>forgotten</from>
					<to>value</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="e5d5f25f-39b6-46bc-95a0-38b70efce468"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>result43b28b9850a6408483e5f6d77a072b3f/date</from>
					<to>expires</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="37ac0730-f694-4ba6-ab4d-66b595645f5f"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>input/webApplicationId</from>
					<to>webApplicationId</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="d1035125ba70447e935027cbbab9ce57"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result9cb5728e344f47af8f4d9a5a93fc8bd1/cookie</from>
				<to>output/header/setCookie</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="3f10e8a5-8d26-40a4-90de-4b1524a56f97"
					serviceId="nabu.utils.Date.incrementDuration"
					resultName="result43b28b9850a6408483e5f6d77a072b3f"
					temporaryMapping="true"
					x="56"
					y="203"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="92935074-4443-4857-9513-e35eaa492ac5"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>-1</from>
					<to>times</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="255ba230-70a5-4f1d-91e5-11ea192470e0"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>P1D</from>
					<to>duration</to>
				</steps>
			</steps>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Sequence"
			comment="If we are a valid user, let's also include the roles and permissions you potentially have access to"
			disabled="false"
			id="d94fb19b-163c-4cc7-b998-51d3deb96aa4"
			label="output/content/token != null &amp;&amp; token/authenticationId != null"
			lineNumber="16">
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				comment="Get the node for this (presumably) user"
				disabled="false"
				id="64f9e8e9-b28e-445f-86dc-47a80bf3aec6"
				lineNumber="17">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="ab544db2-4feb-4a95-8de8-cf5a8cd74ce0"
					serviceId="nabu.cms.core.crud.node.services.get"
					resultName="result91483f1a100c47adbbbd006515a71d55"
					temporaryMapping="true"
					x="124"
					y="27"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="a2ca82a9-6ad5-4417-af45-22c2efb9ec8b"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>token/authenticationId</from>
					<to>id</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="feaa0914-c79d-4671-897c-4e42b81954c7"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result91483f1a100c47adbbbd006515a71d55/result</from>
				<to>node</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				disabled="false"
				id="53d3051e-fbb1-471f-9ac3-40b10dd90708"
				label="node"
				lineNumber="18">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="e5691439-c441-4220-8632-2964dcf7f833"
					serviceId="nabu.cms.core.database.user.selectPotentialRoles"
					resultName="result53bac97269bb4a72ac4651687fda73e5"
					temporaryMapping="true"
					x="138"
					y="37"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="843aefae-02ec-4645-a3b0-775f5dfa5220"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>token/authenticationId</from>
					<to>parameters/userId</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="86559db0-0b28-40ba-aeb2-0b27484ce695"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result53bac97269bb4a72ac4651687fda73e5/results/name</from>
				<to>output/content/roles</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				disabled="false"
				id="9a327171-dc0d-4df0-a00a-de2c9445dcb1"
				label="node"
				lineNumber="19">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="a84331b8-cff2-4396-af09-ccc1eea237bd"
					serviceId="nabu.cms.core.database.user.selectPotentialActions"
					resultName="result70dbd37e3eff4ad4a3fbaf4e8ccef608"
					temporaryMapping="true"
					x="169"
					y="65"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="4c60cfaa-c8ba-415d-853b-96e4e96e2414"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>token/authenticationId</from>
					<to>parameters/userId</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="b917030d-9d1b-43af-8645-5b66b907538b"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result70dbd37e3eff4ad4a3fbaf4e8ccef608/results/name</from>
				<to>output/content/permissions</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				comment="Get the language set for this user (if any)"
				disabled="false"
				id="d396098d-4046-459d-adda-fbee3933ab92"
				label="node/languageId != null"
				lineNumber="20">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="ff37d857-3443-4c7d-b5c6-e7e55d54693b"
					serviceId="nabu.cms.core.crud.masterDataEntry.services.get"
					resultName="resultd2c5031c5d35464e800d6b24fc85cfd4"
					temporaryMapping="true"
					x="61"
					y="50"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="3d6878de-5295-4480-a04c-30cea52f948b"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>node/languageId</from>
					<to>id</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="b996ba9f-5f7e-4065-b1d9-ef5d0863aa8d"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>resultd2c5031c5d35464e800d6b24fc85cfd4/result/name</from>
				<to>output/content/language</to>
			</steps>
		</steps>
	</steps>
	<steps xsi:type="be.nabu.libs.services.vm.step.Switch"
			comment="Set basic role"
			disabled="false"
			id="a909e248-136c-4e71-ba4e-d81564a52724"
			lineNumber="21">
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				comment="Add $user as most basic role if the login was successful"
				disabled="false"
				id="58fbf90d-a971-4ea4-929a-7a4f6b5addad"
				label="output/content/token != null"
				lineNumber="22">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="2f609b65-2988-4196-b93d-22be0c96bdbd"
					serviceId="nabu.utils.List.add"
					resultName="result128834c8b1614319b1c9033cda1610b9"
					temporaryMapping="true"
					x="86"
					y="48"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="583ede49-24a4-425c-a57e-d105c426c3d1"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>output/content/roles</from>
					<to>list</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="d7dd407d-ee08-41a8-8680-40d12fce122b"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>$user</from>
					<to>object</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="214fb1fb-b006-49c3-ad0f-4a9b60f7e00f"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result128834c8b1614319b1c9033cda1610b9/list</from>
				<to>output/content/roles</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="bc1bc21e-87a0-4120-a0ae-70a9c9ab37c4"
					serviceId="nabu.cms.core.database.action.selectByRoleName"
					resultName="result3b686971eb0b4ace8693277a8c2a878b"
					temporaryMapping="true"
					x="87"
					y="196"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="af9a90d6-80a6-463a-94a1-72b68b236689"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>$user</from>
					<to>parameters/roleName</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="a75e6b5a-3dbb-4af7-b99b-71039e2b38a3"
					serviceId="nabu.utils.List.addAll"
					resultName="result380babbd70ba43bc83ff4f09b0e68ef8"
					temporaryMapping="true"
					x="526"
					y="184"
					invocationOrder="1"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="ec4e1abb-a242-4038-a59e-a176027f3ac1"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>result3b686971eb0b4ace8693277a8c2a878b/results/name</from>
					<to>objects</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="e7d92df5-98a2-444b-91ac-315a9d95b584"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>output/content/permissions</from>
					<to>list</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="5c4717ef-1cbf-4fa6-bfd5-7d26e732ee61"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result380babbd70ba43bc83ff4f09b0e68ef8/list</from>
				<to>output/content/permissions</to>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Map"
				comment="Set $guest and any permissions that come with it"
				disabled="false"
				id="16043f5c-f02a-41e4-b09a-14f6a240bbb8"
				lineNumber="23">
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="d8cf7fd6-52be-49ba-a68c-3f0e212c784e"
					serviceId="nabu.cms.core.database.action.selectByRoleName"
					resultName="resultf4ecf28a4f7b42e7a3eb3ce5f37a4b89"
					temporaryMapping="true"
					x="56"
					y="35"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="72527068-b670-4a8d-ad70-af44d368b630"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>$guest</from>
					<to>parameters/roleName</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="e6a42225-8c66-4d80-9c9b-4d950c6b1d72"
					serviceId="nabu.utils.List.add"
					resultName="result153e093538ee4906aa77536803904d8a"
					temporaryMapping="true"
					x="88"
					y="305"
					invocationOrder="0"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="4388c60a-7513-43b4-81e5-db4561cf4aad"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>output/content/roles</from>
					<to>list</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="d4668f70-5a7d-4230-8db6-8d4eb1819103"
						mask="false"
						optional="false"
						fixedValue="true">
					<from>$guest</from>
					<to>object</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="220c4d9b-ebce-4863-91a8-d5c636bfe2b6"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>result153e093538ee4906aa77536803904d8a/list</from>
				<to>output/content/roles</to>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Invoke"
					disabled="false"
					id="7d01faa0-db7f-4a26-ab4a-c906bdb9c77c"
					serviceId="nabu.utils.List.addAll"
					resultName="resultfce603577c174a008f97b9a36020a275"
					temporaryMapping="true"
					x="556"
					y="74"
					invocationOrder="1"
					asynchronous="false"
					recache="false">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="29a17491-a37f-4166-aa7c-2b2defae7e2c"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>output/content/permissions</from>
					<to>list</to>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Link"
						disabled="false"
						id="1e877265-fa47-41fb-8a83-cf5fb7162f4d"
						mask="false"
						optional="false"
						fixedValue="false">
					<from>resultf4ecf28a4f7b42e7a3eb3ce5f37a4b89/results/name</from>
					<to>objects</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Link"
					disabled="false"
					id="b5240472-51a4-4f91-b2ed-992257107151"
					mask="false"
					optional="false"
					fixedValue="false">
				<from>resultfce603577c174a008f97b9a36020a275/list</from>
				<to>output/content/permissions</to>
			</steps>
		</steps>
	</steps>
</sequence>