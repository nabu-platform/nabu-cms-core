<sequence xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" disabled="false" id="c9b31911-5cb9-4cc5-8d96-eb749bb4bd21">
	<steps xsi:type="be.nabu.libs.services.vm.step.Switch" disabled="false" id="2d407e8e-93f9-48eb-81cd-0d9bb7602e0a" query="input/token">
		<steps xsi:type="be.nabu.libs.services.vm.step.Switch" disabled="false" label="null" id="3e99abb4-758b-428f-b103-326efce7c781" query="input/role">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="&quot;$guest&quot;" comment="Pseudo role for non-logged in user" id="8ad0f17a-a57c-428c-9c76-6c02e849b87f">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="f9dc1a44-4644-4e09-b1a2-80ba46f4df2e" fixedValue="true" optional="false">
					<from>true</from>
					<to>output/response</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="063bf6f8-8411-467a-98fb-877f0b9aeee8">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="3dd18ebb-15cf-4971-b1c7-6e42fdc35b00" fixedValue="true" optional="false">
					<from>false</from>
					<to>output/response</to>
				</steps>
			</steps>
		</steps>
		<steps xsi:type="be.nabu.libs.services.vm.step.Switch" disabled="false" id="ddc6572b-f4f3-4cf4-9eeb-8fbf15b9d987">
			<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" label="input/role = &quot;$user&quot;" comment="Pseudo role for logged in user" id="af191088-393c-4154-9a10-9ff2fc8c042e">
				<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="7b42bf3a-9004-4571-887a-d454317af37a" fixedValue="true" optional="false">
					<from>true</from>
					<to>output/response</to>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" label="input/role ~ &quot;\$.*&quot;" comment="Other pseudo roles are only supported if you provide a handler" id="c9d018f3-8b1b-42bd-ba22-9bd5b42a7530">
				<steps xsi:type="be.nabu.libs.services.vm.step.Switch" disabled="false" id="304a7ae6-4876-45ec-a472-fc83714356f2">
					<steps xsi:type="be.nabu.libs.services.vm.step.Throw" disabled="false" label="input/configuration/implementations/hasPseudoRole == null" id="1b380f14-c33e-4ed5-98a5-d4e6d02fcf32" message="=&quot;Can not resolve pseudo role '&quot; + input/role + &quot;' because no handler has been set&quot;" xsi:nil="true"/>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="0decdb5c-45a7-49bd-a429-6758f94d0fc8">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="ceeccdf9-407b-4ed8-82c8-59696c93117c" invocationOrder="0" temporaryMapping="true" serviceId="nabu.cms.core.interfaces.hasPseudoRole" resultName="result937ed62a831845079dfa193fa8c97ee0" x="107" y="48">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="2e017cc1-aae8-42f7-9efa-723ac06f4b22" fixedValue="false" optional="false">
							<from>input/role</from>
							<to>role</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="17b41a5f-f682-405d-adc1-24dc1ce334b0" fixedValue="false" optional="false">
							<from>input/token</from>
							<to>token</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="2d5a1a6e-d86e-4fcf-9f6f-4db981f08799" fixedValue="false" optional="false">
							<from>input/configuration/implementations/hasPseudoRole</from>
							<to>implementationId</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="1ecc2865-9612-40fe-bee2-2f430ef5cf9c" fixedValue="false" optional="false">
						<from>result937ed62a831845079dfa193fa8c97ee0/hasRole</from>
						<to>output/response</to>
					</steps>
				</steps>
			</steps>
			<steps xsi:type="be.nabu.libs.services.vm.step.Sequence" disabled="false" id="7a44d212-d315-47be-8807-95b4504cad19">
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" id="d41507af-7f63-44d8-8aaa-1a3ad71079f0">
					<steps xsi:type="be.nabu.libs.services.vm.step.Invoke" disabled="false" id="8edd6c9c-434c-4ca5-8dbb-af30fe87a80e" invocationOrder="0" temporaryMapping="true" serviceId="nabu.cms.core.providers.security.getUserRoles" resultName="resultcfad4a86d8454d59bac90b2993596030" x="30" y="52">
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="6431a274-219c-4800-832a-d5673cc5062b" fixedValue="false" optional="false">
							<from>input/configuration/connectionId</from>
							<to>connection</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="cfb12505-3103-4958-8df2-2fe5a1a74728" fixedValue="false" optional="false">
							<from>input/token/realm</from>
							<to>realm</to>
						</steps>
						<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="160e67a2-ea6d-47dd-9563-76dba4384ec9" fixedValue="false" optional="false">
							<from>input/token/name</from>
							<to>alias</to>
						</steps>
					</steps>
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="24ee19a2-9f46-44ee-ad36-9974a70396a3" fixedValue="false" optional="false">
						<from>resultcfad4a86d8454d59bac90b2993596030/roles[name = /input/role and pseudo = false]</from>
						<to>requestedRole</to>
					</steps>
				</steps>
				<steps xsi:type="be.nabu.libs.services.vm.step.Map" disabled="false" comment="Set output" id="4f86f649-0b64-4457-90a7-d054b77fab36">
					<steps xsi:type="be.nabu.libs.services.vm.step.Link" disabled="false" id="14eb8c39-a042-4408-b9a7-4a134bb8c4fd" fixedValue="true" optional="false">
						<from>=requestedRole != null</from>
						<to>output/response</to>
					</steps>
				</steps>
			</steps>
		</steps>
	</steps>
</sequence>